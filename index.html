<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>LuaPaste — cole seu script</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; margin:20px; background:#f7f7f8; color:#111 }
    .container { max-width:900px; margin:0 auto; }
    textarea { width:100%; height:320px; font-family: monospace; padding:12px; box-sizing:border-box; font-size:13px; }
    .row { display:flex; gap:8px; align-items:center; margin-top:8px }
    .btn { padding:10px 14px; border:0; background:#2b6df6; color:white; cursor:pointer; border-radius:6px }
    .small { font-size:13px; color:#555 }
    .linkbox { margin-top:12px; background:#fff; padding:12px; border-radius:6px; border:1px solid #e6e6e9 }
    .blank { height:60vh; background:#fff }
  </style>
</head>
<body>
  <div class="container">
    <h1>LuaPaste</h1>
    <p class="small">Cole seu script Lua abaixo e clique em <strong>Gerar</strong>. Você receberá um link público que aponta para um arquivo com nome aleatório <code>timestamp-randomhex.lua</code>.</p>

    <textarea id="code" placeholder="-- cole seu script lua aqui..."></textarea>

    <div class="row">
      <button id="btn" class="btn">Gerar</button>
      <span class="small">Tamanho máximo recomendado: ~50 KB</span>
    </div>

    <div id="result" class="linkbox" style="display:none"></div>

    <hr>

    <h3>Como funciona</h3>
    <ol>
      <li>O servidor recebe o código via POST em <code>/paste</code>.</li>
      <li>Gera um id como <code>&lt;timestamp&gt;-&lt;randomhex&gt;</code> e salva como <code>&lt;id&gt;.lua</code>.</li>
      <li>Retorna URLs para acesso bruto (<code>/pastes/&lt;file&gt;</code>) e para download (<code>/download/&lt;file&gt;</code>).</li>
    </ol>

    <p class="small">Nota: este projeto é um exemplo educativo. Para produção, adicione autenticação, rate-limiting, escaneamento de conteúdo e limpeza periódica dos arquivos.</p>
  </div>

<script>
document.getElementById('btn').addEventListener('click', async () => {
  const code = document.getElementById('code').value;
  if (!code.trim()) { alert('Cole algum código primeiro'); return; }
  const resp = await fetch('/paste', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ code })
  });
  if (!resp.ok) {
    const t = await resp.text();
    alert('Erro: ' + t);
    return;
  }
  const j = await resp.json();
  const html = `<strong>Links gerados:</strong><br>
    Raw: <a href="${j.raw}" target="_blank">${j.raw}</a><br>
    Download: <a href="${j.download}" target="_blank">${j.download}</a><br>
    Filename: <code>${j.filename}</code>`;
  const box = document.getElementById('result');
  box.style.display = 'block';
  box.innerHTML = html;
});
</script>
</body>
</html>